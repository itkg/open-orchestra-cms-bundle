{# factorization of archestra_areas and archestra_blocks behavior #}
{% block generic_behavior %}
    {{ form_widget(form) }}
    {% if parameter is defined %}
        {{ push_html(render(controller(controller, parameter))) }}
    {% else %}
        {{ push_html(render(controller(controller))) }}
    {% endif %}
{% endblock %}

{% block orchestra_areas_widget %}
    {{ block('generic_behavior') }}
{% endblock %}

{% block orchestra_blocks_widget %}
    {{ block('generic_behavior') }}
{% endblock %}

{% block blocks_widget %}
    {{ unshift_js(asset('bundles/phporchestracms/js/pagegenerator/block.js')) }}
    {{ form_widget(form) }}
{% endblock %}

{% block textarea_widget %}
{% spaceless %}
    <textarea rows="5" {{ block('widget_attributes') }}>{{ value }}</textarea>
{% endspaceless %}
{% endblock textarea_widget %}

{% extends "form_div_layout.html.twig" %}

{% block form_row %}
{% spaceless %}
    <section>
    {% set file = "PHPOrchestraCMSBundle:Block/" ~ block_prefixes[1]|capitalize ~ ":extend.html.twig" %}
    {% if twig_exists(file) %}
        {% include file %}
    {% endif %}
    {% if block_prefixes[1] == 'checkbox' %}
        <label class="checkbox"{% if errors|length > 0 %} state-error{% endif %}>
            {{ form_widget(form) }}
            <i></i>{{ form_label(form, null, {'label_attr': {'class': 'label'}}) }}</label>
    {% elseif block_prefixes[2] == 'textarea' %}
        {{ form_label(form, null, {'label_attr': {'class': 'label'}}) }}
        <label class="textarea textarea-resizable{% if errors|length > 0 %} state-error{% endif %}">
            {{ form_widget(form) }}
        </label>
    {% elseif block_prefixes[1] == 'contentAttributes' %}
        {{ form_widget(form) }}
    {% else %}
        {{ form_label(form, null, {'label_attr': {'class': 'label'}}) }}
        <label class="label {% if errors|length > 0 %}state-error {% endif %}{{ block_prefixes[1]|lexicon_translator }} {% if multiple is defined and multiple %} select-multiple{% endif %}">
            {{ form_widget(form) }}{% if multiple is not defined or not multiple %}<i></i>{% endif %}
        </label>
    {% endif %}
        <div class="note note-error">
            {{ form_errors(form) }}
        </div>
    </section>
{% endspaceless %}
{% endblock form_row %}

{% block form %}
{% spaceless %}
    {% set html %}
    {% if form.vars.beginJs is defined %}
        {% for js in form.vars.beginJs %}
            {{ unshift_js(asset('bundles/phporchestracms/js/') ~ js) }}
        {% endfor %} 
    {% endif %}
    {% if form.vars.endJs is defined %}
        {% for js in form.vars.endJs %}
            {{ push_js(asset('bundles/phporchestracms/js/') ~ js) }}
        {% endfor %} 
    {% endif %}
    {% if form.vars.inDialog is defined and form.vars.inDialog %}
        <div id="dialog-{{ form.vars.name }}" style="display:none;" title="{{ form.vars.name }}">
    {% endif %}
    {{ form_start(form, {'attr': {'class': 'smart-form'}}) }}
        <fieldset>
        {{ form_widget(form) }}
        </fieldset>
    {{ form_rest(form) }}
    {{ form_end(form) }}
    {% if form.vars.inDialog is defined  and form.vars.inDialog %}
        </div>
    {% endif %}
    {% endset %}
    {% if form.vars.subForm is not defined %}
        {{ print_html(html) }}
        {{ print_js() }}
    {% else %}
        {{ html }}
    {% endif %}
{% endspaceless %}
{% endblock form %}

{% block form_widget_compound %}
{% spaceless %}
    {% if form.parent is empty %}
        {{ form_errors(form) }}
    {% endif %}
    {{ block('form_rows') }}
    {{ form_rest(form) }}
{% endspaceless %}
{% endblock form_widget_compound %}
