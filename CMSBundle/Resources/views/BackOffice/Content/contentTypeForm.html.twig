{##
 # This file is part of the PHPOrchestra\CMSBundle.
 #
 # @author NoÃ«l GILAIN <noel.gilain@businessdecision.com>
 ##}

{% extends 'PHPOrchestraCMSBundle:BackOffice:contentLayout.html.twig' %}

{% block beforeSmartDiv %}
    <ul class="nav nav-tabs" id="languages">
    {% if contentTypeVersions|length > 0 %}
        <li class="pull-right active">
            <div class="versionContainer">
                <select class="selectSwitcher">
                    <option value="{{ path(
                        'phporchestra_cms_backofficeview_contenttype_index',
                        {
                            'action' : 'duplicate',
                            'id' : form.vars.value.id.__toString()
                        }
                    ) }}" data-loadmode="ajax">{{ 'contentTypes.form.newVersion'|trans({}, 'backOffice') }}</option>
                {% for version in contentTypeVersions %}
                    <option value="{{ path(
                        'phporchestra_cms_backofficeview_contenttype_index',
                        {
                            'action' : 'edit',
                            'id' : version.id.__toString()
                        }
                    ) }}" {% if version.version == form.vars.value.version %}selected="selected"{% endif %}
                    >{{ 'contentTypes.form.version%versionNumber%'|trans({'versionNumber':version.version}, 'backOffice') }} ({{ version.status }})</option>
                {% endfor %}
                </select>
            </div>
        </li>
    {% endif %}
    </ul>
{% endblock %}

{% block mainContent %}
    {{ form_start(
        form,
        {
            'attr': {'class': 'smart-form'},
            'method': 'POST',
            'action': path('phporchestra_cms_backofficeview_contenttype_index', {'action' : 'edit', 'id': form.id.vars.value})
        }
    ) }}
    
    {{ form_errors(form) }}
    
    <fieldset>
        <legend>{{ 'contentTypes.form.typeDefinition'|trans({}, 'backOffice') }}</legend>
        {{ form_row(form.new_field) }}
        {{ form_row(form.contentTypeId) }}
        {{ form_row(form.status) }}
        {{ form_widget(form.name) }}
        {{ form_row(form.version) }}
    </fieldset>
    {{ form_widget(form.fields) }}
    
    {{ form_end(form) }}
{% endblock %}

{% block afterSmartDiv %}
    <div class="ribbon">
        {{ ribbon|raw }}
    </div>
    
    <script type="text/javascript">
        $('#newFieldSelector').change(function() {
            $('#contentType_new_field').val($(this).val());
        });
    </script>
{% endblock %}
